<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Umair's Weather APP</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --light-bg: #8ecae6;
      --dark-bg: #023047;
      --text-light: #023047;
      --text-dark: #ffffff;
      --card-light: #ffffff;
      --card-dark: #1b1f2b;
      --accent: #ffb703;
      --highlight: #fb8500;
      --primary: #219ebc;
    }

    [data-theme="light"] {
      --bg: var(--light-bg);
      --text: var(--text-light);
      --card: var(--card-light);
    }

    [data-theme="dark"] {
      --bg: var(--dark-bg);
      --text: var(--text-dark);
      --card: var(--card-dark);
    }

    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(to right, #03045e, #0077b6, #00b4d8, #90e0ef, #caf0f8);
      color: var(--text);
      padding: 20px;
      transition: 0.3s ease;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .search input {
      padding: 12px;
      width: 70%;
      border-radius: 30px;
      border: none;
      font-size: 16px;
      outline: none;
      background: #ffffffc0;
      color: var(--text);
    }

    .toggle {
      background: var(--accent);
      color: var(--text);
      border: none;
      border-radius: 30px;
      padding: 10px 20px;
      cursor: pointer;
      font-weight: bold;
    }

    .card {
      background: linear-gradient(to right, #ffc300, #ffd60a);
      color: var(--text);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .weather-main {
      text-align: center;
    }

    .weather-main img {
      width: 100px;
    }

    .metrics {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .metric {
      display: flex;
      align-items: center;
      gap: 6px;
      background: var(--bg);
      padding: 8px 12px;
      border-radius: 10px;
      font-size: 14px;
    }

    .metric img {
      width: 20px;
    }

    .forecast {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      background-color: #ced;
      border-radius: 10px;
    }

    .forecast-day {
      background: var(--card);
      border-radius: 10px;
      text-align: center;
      padding: 10px;
      background-color: #ced4da;
    }

    .forecast-day img {
      width: 50px;
    }
  </style>
</head>
<body>
    <h1 style="text-align: center; color: var(--text);">Made by Umair</h1>
<div class="container" data-theme="light">
  <div class="header">
    <input type="text" id="cityInput" placeholder="Enter city name...">
    <button class="toggle" onclick="toggleTheme()">Toggle Theme</button>
  </div>

  <div id="weather" style="display: none;">
    <div class="card weather-main">
      <h2 id="cityName"></h2>
      <img id="icon" />
      <h3 id="description"></h3>
      <h1 id="temp"></h1>
      <div class="metrics">
        <div class="metric"><img src="https://img.icons8.com/color/48/thermometer.png"/> <span id="feels"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/humidity.png"/> <span id="humidity"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/wind.png"/> <span id="wind"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/atmospheric-pressure.png"/> <span id="pressure"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/fog-day.png"/> <span id="visibility"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/clouds.png"/> <span id="clouds"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/sunrise.png"/> <span id="sunrise"></span></div>
        <div class="metric"><img src="https://img.icons8.com/color/48/sunset.png"/> <span id="sunset"></span></div>
      </div>
    </div>

    <h3>5-Day Forecast</h3>
    <div class="forecast" id="forecast"></div>
  </div>
</div>

<script>
const apiKey = "56bc161f08d7c12971025fc7d82dc687";

document.getElementById("cityInput").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    const city = e.target.value.trim();
    if (city) fetchWeather(city);
  }
});

function toggleTheme() {
  const container = document.querySelector(".container");
  const current = container.getAttribute("data-theme");
  const newTheme = current === "dark" ? "light" : "dark";
  container.setAttribute("data-theme", newTheme);
  localStorage.setItem("theme", newTheme);
}
window.onload = () => {
  const theme = localStorage.getItem("theme") || "light";
  document.querySelector(".container").setAttribute("data-theme", theme);
};

function formatTime(unix) {
  return new Date(unix * 1000).toLocaleTimeString("en-US", {
    hour: "2-digit", minute: "2-digit"
  });
}

function groupByDay(forecastList) {
  const daily = {};
  forecastList.forEach(item => {
    const date = item.dt_txt.split(" ")[0];
    if (!daily[date]) daily[date] = [];
    daily[date].push(item);
  });
  return daily;
}

async function fetchWeather(city) {
  try {
    const currentRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`);
    if (!currentRes.ok) throw new Error("City not found");
    const current = await currentRes.json();

    document.getElementById("cityName").textContent = current.name;
    document.getElementById("icon").src = `https://openweathermap.org/img/wn/${current.weather[0].icon}@2x.png`;
    document.getElementById("description").textContent = current.weather[0].description;
    document.getElementById("temp").textContent = Math.round(current.main.temp) + "°C";
    document.getElementById("feels").textContent = `Feels like: ${Math.round(current.main.feels_like)}°C`;
    document.getElementById("humidity").textContent = `Humidity: ${current.main.humidity}%`;
    document.getElementById("wind").textContent = `Wind: ${current.wind.speed} km/h`;
    document.getElementById("pressure").textContent = `Pressure: ${current.main.pressure} hPa`;
    document.getElementById("visibility").textContent = `Visibility: ${(current.visibility / 1000).toFixed(1)} km`;
    document.getElementById("clouds").textContent = `Clouds: ${current.clouds.all}%`;
    document.getElementById("sunrise").textContent = formatTime(current.sys.sunrise);
    document.getElementById("sunset").textContent = formatTime(current.sys.sunset);

    const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${apiKey}`);
    const forecastData = await forecastRes.json();

    const grouped = groupByDay(forecastData.list);
    const forecast = document.getElementById("forecast");
    forecast.innerHTML = "";

    Object.entries(grouped).slice(0, 5).forEach(([date, list]) => {
      const avgTemp = (list.reduce((sum, item) => sum + item.main.temp, 0) / list.length).toFixed(1);
      const icon = list[0].weather[0].icon;
      const pop = Math.round((list.reduce((sum, item) => sum + (item.pop || 0), 0) / list.length) * 100);

      const el = document.createElement("div");
      el.classList.add("forecast-day");
      el.innerHTML = `
        <h4>${new Date(date).toDateString().split(" ").slice(0, 3).join(" ")}</h4>
        <img src="https://openweathermap.org/img/wn/${icon}.png" />
        <p>${avgTemp}°C</p>
        <p>POP: ${pop}%</p>
      `;
      forecast.appendChild(el);
    });

    document.getElementById("weather").style.display = "block";
  } catch (err) {
    alert(err.message);
    document.getElementById("weather").style.display = "none";
  }
}
</script>
</body>
</html>
